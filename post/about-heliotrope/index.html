<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="shortcut icon" href="/static/saebasol.icon.png"/><title>About Heliotrope | Saebasol</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="무슨 마약하셨길래 이런거 만드셨나요?"/><meta name="twitter:card" content="summary_large_image"/><meta property="og:type" content="article"/><meta property="og:title" content="About Heliotrope"/><meta property="og:description" content="무슨 마약하셨길래 이런거 만드셨나요?"/><meta property="og:image" content="simson_druggg.jpg"/><meta property="og:image:alt" content="Thumbnail of About Heliotrope on undefined."/><meta name="next-head-count" content="13"/><link rel="preload" href="/_next/static/css/d4992c3366463a46b999.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d4992c3366463a46b999.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-b78a0c769d36e7eef574.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.4012791932e9f5689531.js" as="script"/><link rel="preload" href="/_next/static/chunks/a0722373.a96f372fbac90ed0bc91.js" as="script"/><link rel="preload" href="/_next/static/chunks/7de4ed1085c5be3520cfe4b310dbaa2afeef88da.115d32a11aa091be966a.js" as="script"/><link rel="preload" href="/_next/static/chunks/14fd5275d4bbdbf606c5ae4a6109f5bb310e18a0.c03751eaa70038bfd13f.js" as="script"/><link rel="preload" href="/_next/static/chunks/94ac8896463642b673bdd9a437a96f00591a6ad8.8e125ec5b52d0fcc9a47.js" as="script"/><link rel="preload" href="/_next/static/chunks/be2f8df8c2c8cc83698c027fe529fd98ee6ea3ce.0746e855198c8743202a.js" as="script"/><link rel="preload" href="/_next/static/chunks/b44e4af87672e97627f752c1ce5896fd24a747b2.94c3935e876b0b466c33.js" as="script"/><link rel="preload" href="/_next/static/chunks/af34e2db61f97cedc6ebfbaa0d751a83f9f0d9f6.d30da2fa2fe476243b07.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-7904a20271c4761d2a49.js" as="script"/><link rel="preload" href="/_next/static/chunks/e7a6caeb.ded972b50bbdd7ab7ea3.js" as="script"/><link rel="preload" href="/_next/static/chunks/686e6332.89681c4dcde130485dd7.js" as="script"/><link rel="preload" href="/_next/static/chunks/321dfbae.7b994ab64ce442378af9.js" as="script"/><link rel="preload" href="/_next/static/chunks/c82dffd34f5e63cb87dd90dca9c2897dd7794679.23e3fb14584ad9a717d3.js" as="script"/><link rel="preload" href="/_next/static/chunks/1173eff4538ab0eae4f3f506dea9a7965770ad37.4a63bcd2139829e6a011.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/post/%5Bslug%5D-5c632475bb0a040bf113.js" as="script"/></head><body><div id="__next"><style data-emotion="css-global 1syi0wy">html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;touch-action:manipulation;}body{position:relative;min-height:100%;font-feature-settings:'kern';}*,*::before,*::after{border-width:0;border-style:solid;box-sizing:border-box;}main{display:block;}hr{border-top-width:1px;box-sizing:content-box;height:0;overflow:visible;}pre,code,kbd,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:1em;}a{background-color:transparent;color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:bold;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{-webkit-appearance:none!important;}input[type="number"]{-moz-appearance:textfield;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none!important;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:-webkit-box;display:-webkit-list-item;display:-ms-list-itembox;display:list-item;}template{display:none;}[hidden]{display:none!important;}body,blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0;}button{background:transparent;padding:0;}fieldset{margin:0;padding:0;}ol,ul{margin:0;padding:0;}textarea{resize:vertical;}button,[role="button"]{cursor:pointer;}button::-moz-focus-inner{border:0!important;}table{border-collapse:collapse;}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle;}img,video{max-width:100%;height:auto;}[data-js-focus-visible] :focus:not([data-focus-visible-added]){outline:none;box-shadow:none;}select::-ms-expand{display:none;}</style><style data-emotion="css-global 1ct3dms">body{font-family:Inter,Noto Sans KR;color:#1A202C;background:#FFFFFF;-webkit-transition:background-color 0.2s;transition:background-color 0.2s;line-height:1.5;}*::-webkit-input-placeholder{color:#A0AEC0;}*::-moz-placeholder{color:#A0AEC0;}*:-ms-input-placeholder{color:#A0AEC0;}*::placeholder{color:#A0AEC0;}*,*::before,::after{border-color:#E2E8F0;word-wrap:break-word;}</style><style data-emotion="css 89v9aq">.css-89v9aq{background:#000000;margin-bottom:25px;}</style><div class="css-89v9aq"><style data-emotion="css 1piyyew">.css-1piyyew{width:100%;margin-left:auto;margin-right:auto;max-width:1000px;padding-left:1rem;padding-right:1rem;}</style><div class="chakra-container css-1piyyew"><style data-emotion="css ekty9c">.css-ekty9c{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:9px 0;}</style><div class="css-ekty9c"><style data-emotion="css j8x285">.css-j8x285{font-family:Inter,Noto Sans KR;font-weight:700;font-size:0.875rem;line-height:1.2;padding-right:16px;color:#E2E8F0;}</style><h2 class="chakra-heading css-j8x285"><style data-emotion="css 1bvdrhg">.css-1bvdrhg{-webkit-transition:all 0.15s ease-out;transition:all 0.15s ease-out;cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:none;color:inherit;}.css-1bvdrhg:hover,.css-1bvdrhg[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-1bvdrhg:focus,.css-1bvdrhg[data-focus]{box-shadow:0 0 0 3px rgba(66, 153, 225, 0.6);}</style><a href="/">Saebasol</a></h2><h2 class="chakra-heading css-j8x285"><a href="/about/">About</a></h2><style data-emotion="css 17xejub">.css-17xejub{-webkit-flex:1;-ms-flex:1;flex:1;justify-self:stretch;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;}</style><div class="css-17xejub"></div><style data-emotion="css dajk44">.css-dajk44{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;color:#E2E8F0;background:#000000;}.css-dajk44>*:not(style)~*:not(style){margin-left:0.2rem;}</style><div role="group" class="chakra-button__group css-dajk44"><style data-emotion="css ql0pmr">.css-ql0pmr{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-transition:all 250ms;transition:all 250ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;white-space:nowrap;vertical-align:middle;outline:none;width:auto;line-height:1.2;border-radius:0.375rem;font-weight:600;height:2rem;min-width:2rem;font-size:0.875rem;padding-left:0.75rem;padding-right:0.75rem;color:inherit;padding:0;}.css-ql0pmr:focus,.css-ql0pmr[data-focus]{box-shadow:0 0 0 3px rgba(66, 153, 225, 0.6);z-index:1;}.css-ql0pmr[disabled],.css-ql0pmr[disabled]:focus,.css-ql0pmr[disabled]:hover,.css-ql0pmr[aria-disabled=true],.css-ql0pmr[aria-disabled=true]:focus,.css-ql0pmr[aria-disabled=true]:hover,.css-ql0pmr[data-disabled],.css-ql0pmr[data-disabled]:focus,.css-ql0pmr[data-disabled]:hover{opacity:0.4;cursor:not-allowed;box-shadow:none;}.css-ql0pmr:hover,.css-ql0pmr[data-hover]{background-color:#1A202C;}.css-ql0pmr:active,.css-ql0pmr[data-active]{background:#E2E8F0;}</style><button type="button" class="chakra-button css-ql0pmr"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" aria-hidden="true" focusable="false" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path fill-rule="nonzero" d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></g></svg></button><button type="button" class="chakra-button css-ql0pmr"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" aria-hidden="true" focusable="false" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"></path><path d="M22.162 5.656a8.384 8.384 0 0 1-2.402.658A4.196 4.196 0 0 0 21.6 4c-.82.488-1.719.83-2.656 1.015a4.182 4.182 0 0 0-7.126 3.814 11.874 11.874 0 0 1-8.62-4.37 4.168 4.168 0 0 0-.566 2.103c0 1.45.738 2.731 1.86 3.481a4.168 4.168 0 0 1-1.894-.523v.052a4.185 4.185 0 0 0 3.355 4.101 4.21 4.21 0 0 1-1.89.072A4.185 4.185 0 0 0 7.97 16.65a8.394 8.394 0 0 1-6.191 1.732 11.83 11.83 0 0 0 6.41 1.88c7.693 0 11.9-6.373 11.9-11.9 0-.18-.005-.362-.013-.54a8.496 8.496 0 0 0 2.087-2.165z"></path></g></svg></button></div></div></div></div><style data-emotion="css 8fcpzi">.css-8fcpzi{width:100%;margin-left:auto;margin-right:auto;max-width:750px;padding-left:1rem;padding-right:1rem;}</style><div class="chakra-container css-8fcpzi"><style data-emotion="css deddn1">.css-deddn1{font-family:Inter,Noto Sans KR;font-weight:700;font-size:3rem;line-height:1;margin:20px 0;}@media screen and (min-width: 48em){.css-deddn1{font-size:3.75rem;}}</style><h2 class="chakra-heading css-deddn1">About Heliotrope</h2><p class="chakra-text css-0">무슨 마약하셨길래 이런거 만드셨나요?</p><style data-emotion="css imf64c">.css-imf64c{opacity:0.6;border:0;border-color:inherit;border-style:solid;border-bottom-width:1px;width:100%;margin:9px 0;}</style><hr role="separator" aria-orientation="horizontal" class="chakra-divider css-imf64c"/><style data-emotion="css 1vgrz58">.css-1vgrz58{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin:16px 0;}.css-1vgrz58>*:not(style)~*:not(style){-webkit-margin-start:0.5rem;margin-inline-start:0.5rem;margin-top:0;}</style><div class="chakra-stack css-1vgrz58"><style data-emotion="css 1scx264">.css-1scx264{border-radius:9999px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;text-align:center;text-transform:uppercase;font-weight:500;position:relative;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;background:transparent;color:#1A202C;border-color:#FFFFFF;vertical-align:top;width:3rem;height:3rem;font-size:calc(3rem / 2.5);}</style><span class="chakra-avatar css-1scx264"><style data-emotion="css uo84k3">.css-uo84k3{font-size:calc(3rem / 2.5);line-height:3rem;}</style><div aria-label="SaidBySolo" class="chakra-avatar__initials css-uo84k3">S</div></span><div class="css-0"><style data-emotion="css 1bvdrhg">.css-1bvdrhg{-webkit-transition:all 0.15s ease-out;transition:all 0.15s ease-out;cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:none;color:inherit;}.css-1bvdrhg:hover,.css-1bvdrhg[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-1bvdrhg:focus,.css-1bvdrhg[data-focus]{box-shadow:0 0 0 3px rgba(66, 153, 225, 0.6);}</style><a class="chakra-link css-1bvdrhg" href="/author/saidbysolo"><style data-emotion="css v4ou1e">.css-v4ou1e{font-family:Inter,Noto Sans KR;font-weight:700;font-size:1.25rem;line-height:1.2;}</style><style data-emotion="css 1boyif6">.css-1boyif6{-webkit-transition:all 0.15s ease-out;transition:all 0.15s ease-out;cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:none;color:inherit;font-family:Inter,Noto Sans KR;font-weight:700;font-size:1.25rem;line-height:1.2;}.css-1boyif6:hover,.css-1boyif6[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-1boyif6:focus,.css-1boyif6[data-focus]{box-shadow:0 0 0 3px rgba(66, 153, 225, 0.6);}</style><a class="chakra-link chakra-heading css-1boyif6">SaidBySolo</a></a><p class="chakra-text css-0">28/05/2021</p></div></div></div><style data-emotion="css yiqt12">.css-yiqt12{width:100%;margin-left:auto;margin-right:auto;max-width:1100px;padding-left:1rem;padding-right:1rem;}</style><style data-emotion="css 1jdqthp">.css-1jdqthp{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:100%;margin-left:auto;margin-right:auto;max-width:1100px;padding-left:1rem;padding-right:1rem;}</style><div class="chakra-container css-1jdqthp"><style data-emotion="css 1jmprma">.css-1jmprma{margin:45px 0;box-shadow:0 25px 50px -12px rgba(0, 0, 0, 0.25);border-radius:0.375rem;}</style><img alt="Thumbnail image of About Heliotrope." class="chakra-image__placeholder css-1jmprma" src="../../static/thumbnails/another-warmness.png"/></div><style data-emotion="css 8fcpzi">.css-8fcpzi{width:100%;margin-left:auto;margin-right:auto;max-width:750px;padding-left:1rem;padding-right:1rem;}</style><div class="chakra-container css-8fcpzi"><style data-emotion="css sklrp3">.css-sklrp3{margin:28px 0;}</style><div class="css-sklrp3"><style data-emotion="css k4c6ps">.css-k4c6ps{font-family:Inter,Noto Sans KR;font-weight:700;font-size:2.25rem;line-height:1.2;margin:26px 0;}@media screen and (min-width: 48em){.css-k4c6ps{font-size:3rem;line-height:1;}}</style><h1 class="chakra-heading css-k4c6ps">헬리오트로프에 대하여</h1><style data-emotion="css 5adzih">.css-5adzih{margin:9px 0;}</style><p class="chakra-text css-5adzih">먼저 헬리오트로프의 탄생 배경을 이야기하기전에 그 당시의 히요봇을 먼저 알아야 하는데요,</p><p class="chakra-text css-5adzih">히요봇이 그 당시에 히요비에 많은 의존성을 두고 있었어요.</p><p class="chakra-text css-5adzih">그래서 봇 이름도 히요봇이였고, 히요비가 makise.me처럼 언젠가는 닫을거 같았습니다.  <del>그리고 이 예상은 정확했습니다.</del></p><p class="chakra-text css-5adzih">이를 해결하기 위해 헬리오트로프를 구상하기 시작했어요.</p><style data-emotion="css krrc24">.css-krrc24{font-family:Inter,Noto Sans KR;font-weight:700;font-size:1.875rem;line-height:1.33;margin:20px 0;}@media screen and (min-width: 48em){.css-krrc24{font-size:2.25rem;line-height:1.2;}}</style><h2 class="chakra-heading css-krrc24">왜 굳이 API로 구상을했나요?</h2><p class="chakra-text css-5adzih">사실 저도 봇쪽에 모든곳을 둘까 생각을 해보았는데</p><p class="chakra-text css-5adzih">봇쪽에 너무 많은 비중을 두기에는 무리가 갔고</p><p class="chakra-text css-5adzih">봇의 배포환경이 Heroku여서 DB를 연동할려면 결국 DB서버를 따로두던가 그곳에서 제공하는 애드온으로 작업을 해야했습니다.</p><p class="chakra-text css-5adzih">애드온으로 작업은 그때 당시에 할 엄두도 내지 못하였고, 그냥 한마디로 <strong>쫄렸습니다</strong></p><p class="chakra-text css-5adzih">DB서버를 따로 둘바에는 차라리 API를 만드는게 좋다 생각하여서 API로 개발을 하게되었습니다.</p><h2 class="chakra-heading css-krrc24">근데 왜 API이름이 헬리오트로프인가요?</h2><p class="chakra-text css-5adzih">헬리오트로프는 꽃말로 성실과 헌신을 의미해요.</p><p class="chakra-text css-5adzih">이 API가 여러분에게 헌신한다는 의미로 지었습니다.</p><style data-emotion="css imf64c">.css-imf64c{opacity:0.6;border:0;border-color:inherit;border-style:solid;border-bottom-width:1px;width:100%;margin:9px 0;}</style><hr role="separator" aria-orientation="horizontal" class="chakra-divider css-imf64c"/><h2 class="chakra-heading css-krrc24">개발 과정</h2><p class="chakra-text css-5adzih">이 API를 만들기전에 먼저 히토미가 굴러가는 과정부터 알아야했습니다.</p><style data-emotion="css 8u6v4g">.css-8u6v4g{font-family:Inter,Noto Sans KR;font-weight:700;font-size:1.5rem;line-height:1.33;margin:16px 0;}@media screen and (min-width: 48em){.css-8u6v4g{font-size:1.875rem;line-height:1.2;}}</style><h3 class="chakra-heading css-8u6v4g">전체적인 구조</h3><p class="chakra-text css-5adzih">1시간 마다 히토미에서 최신정보 가져옴 -&gt; 가져온 정보 DB에 저장 -&gt; 요청시 DB에서 보여주기</p><p class="chakra-text css-5adzih">이게 끝입니다.</p><p class="chakra-text css-5adzih">이미지 프록시를 제외하고는 전부 DB에서 보여주고있습니다.</p><style data-emotion="css fcc6gh">.css-fcc6gh{font-family:Inter,Noto Sans KR;font-weight:700;font-size:1.25rem;line-height:1.2;margin:12px 0;}</style><h4 class="chakra-heading css-fcc6gh">이미지를 가져오는 순서</h4><p class="chakra-text css-5adzih">갤러리 정보 요청 (이미지정보 포함) -&gt; 특수한 로직을 통해 이미지 링크 가져오기 -&gt; 이미지 링크에 referer, User-Agent 넣고 요청 -&gt; 200</p><h4 class="chakra-heading css-fcc6gh">리스트를 가져오는 순서</h4><p class="chakra-text css-5adzih">.nozomi파일 요청 (번호 담겨있음) -&gt; 바이트로 응답온거 struct unpack으로 풀기 -&gt; 번호 정렬</p><h2 class="chakra-heading css-krrc24">그래서 저걸 어떻게 알았나요?</h2><p class="chakra-text css-5adzih">Chrome에서 개발자도구로 js에서 요청하는 것들을 둘러보았고, 여러 사람들이 많은 도움을 주셨습니다.</p><p class="chakra-text css-5adzih"><style data-emotion="css 1bvdrhg">.css-1bvdrhg{-webkit-transition:all 0.15s ease-out;transition:all 0.15s ease-out;cursor:pointer;-webkit-text-decoration:none;text-decoration:none;outline:none;color:inherit;}.css-1bvdrhg:hover,.css-1bvdrhg[data-hover]{-webkit-text-decoration:underline;text-decoration:underline;}.css-1bvdrhg:focus,.css-1bvdrhg[data-focus]{box-shadow:0 0 0 3px rgba(66, 153, 225, 0.6);}</style><a class="chakra-link css-1bvdrhg" href="https://ltn.hitomi.la/common.js">이미지 처리 로직</a>은 이곳에서 볼수 있었습니다.</p><p class="chakra-text css-5adzih">이외에는 충분히 여러분들이 노력만 하시면 어떻게 굴라가는지 보실수 있을겁니다.</p><h2 class="chakra-heading css-krrc24">가져온 정보는 어떻게 저장하나요?</h2><p class="chakra-text css-5adzih">먼저 <strong>이미지는 저장하지 않습니다.</strong> </p><p class="chakra-text css-5adzih">저장용량이 부족할뿐만 아니라, 여러 리스크가있기때문에 프록시로 받는 청크 그대로 넘겨주는것으로 결정했습니다.</p><p class="chakra-text css-5adzih">이외에 자세한 작품정보는 BeautifulSoup를 이용해 파싱후 mongodb에 저장하였고,</p><p class="chakra-text css-5adzih">이미지 정보와 같은것은 MariaDB와 Tortoise ORM을 이용해 저장했습니다.</p><h2 class="chakra-heading css-krrc24">제목검색도 있던데 어떻게 하셨나요?</h2><p class="chakra-text css-5adzih">Mongodb cloud 에서 제공하는 Atlas Search를 이용했습니다.</p><p class="chakra-text css-5adzih">살짝 아쉬운점은 한국어가 아직 제대로 지원하지 않는다는 점입니다.</p><h2 class="chakra-heading css-krrc24">배포는 어떻게 하셨나요?</h2><p class="chakra-text css-5adzih">master 브랜치에 Push가 되면 Azure DevOps가 Docker를 빌드한후 깃허브에 이미지를 릴리즈합니다.</p><p class="chakra-text css-5adzih">배포서버에 ssh로 접속한후 그 이미지를 당겨온후 열어줍니다.</p><p class="chakra-text css-5adzih">그런 다음 Nginx로 리버스 프록시 작업을 해주었습니다.</p><p class="chakra-text css-5adzih">자동화 배포를 무중단배포와 함께 v5에서 기회가된다면 작업해보고싶네요.</p><h2 class="chakra-heading css-krrc24">오류트래킹은 어떻게 하나요?</h2><p class="chakra-text css-5adzih">sentry를 이용해 추적하고있습니다.</p><hr role="separator" aria-orientation="horizontal" class="chakra-divider css-imf64c"/><h2 class="chakra-heading css-krrc24">마지막으로 v4릴리즈를 앞두고..</h2><p class="chakra-text css-5adzih">이글을 보고있으신다면 관심을 가져주시고 있다는거겠죠.</p><p class="chakra-text css-5adzih">먼저 봐주셔서 감사하다는 말씀을 드리고</p><p class="chakra-text css-5adzih">제가 열심히 유지보수한만큼 여러분들이 많이 써주시면 좋겠습니다.</p><p class="chakra-text css-5adzih">v4에 올라오면서 일부 엔드포인트를 제외하고 검증 절차를 삭제했기 때문에 요청하면 사용하실수 있습니다.</p><p class="chakra-text css-5adzih">다른 점이 궁금하신게있다면 디스코드로 질문해주셔도 됩니다.</p><p class="chakra-text css-5adzih">감사합니다!</p><p class="chakra-text css-5adzih"><strong><a class="chakra-link css-1bvdrhg" href="https://blog.doujinshiman.ga/post/saebasol-recruitment/">Saebasol Want you!</a></strong></p><p class="chakra-text css-5adzih"><strong><a class="chakra-link css-1bvdrhg" href="https://discord.gg/PSshFYr">공식 디스코드</a></strong></p></div></div><style data-emotion="css 1gryo0t">.css-1gryo0t{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;padding:24px 0;}</style><div class="css-1gryo0t">Copyright <!-- -->2021<!-- --> <!-- -->Saebasol<!-- --> contributors.</div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"user":{"name":"SaidBySolo","email":"saidbysolo@gmail.com","bio":":D","avatar":"https://avatars.githubusercontent.com/u/33891531"},"data":{"title":"About Heliotrope","author":"saidbysolo","date":1622160000000,"sort":"무슨 마약하셨길래 이런거 만드셨나요?","thumbnail":"simson_druggg.jpg","slug":"about-heliotrope","source":"About Heliotrope"},"mdxModule":"\n# 헬리오트로프에 대하여\n\n먼저 헬리오트로프의 탄생 배경을 이야기하기전에 그 당시의 히요봇을 먼저 알아야 하는데요,\n\n히요봇이 그 당시에 히요비에 많은 의존성을 두고 있었어요.\n\n그래서 봇 이름도 히요봇이였고, 히요비가 makise.me처럼 언젠가는 닫을거 같았습니다.  ~~그리고 이 예상은 정확했습니다.~~\n\n이를 해결하기 위해 헬리오트로프를 구상하기 시작했어요.\n\n## 왜 굳이 API로 구상을했나요?\n\n사실 저도 봇쪽에 모든곳을 둘까 생각을 해보았는데\n\n봇쪽에 너무 많은 비중을 두기에는 무리가 갔고\n\n봇의 배포환경이 Heroku여서 DB를 연동할려면 결국 DB서버를 따로두던가 그곳에서 제공하는 애드온으로 작업을 해야했습니다.\n\n애드온으로 작업은 그때 당시에 할 엄두도 내지 못하였고, 그냥 한마디로 **쫄렸습니다**\n\nDB서버를 따로 둘바에는 차라리 API를 만드는게 좋다 생각하여서 API로 개발을 하게되었습니다.\n\n## 근데 왜 API이름이 헬리오트로프인가요?\n\n헬리오트로프는 꽃말로 성실과 헌신을 의미해요.\n\n이 API가 여러분에게 헌신한다는 의미로 지었습니다.\n\n***\n\n## 개발 과정\n\n이 API를 만들기전에 먼저 히토미가 굴러가는 과정부터 알아야했습니다.\n\n### 전체적인 구조\n\n1시간 마다 히토미에서 최신정보 가져옴 -\u003e 가져온 정보 DB에 저장 -\u003e 요청시 DB에서 보여주기\n\n이게 끝입니다.\n\n이미지 프록시를 제외하고는 전부 DB에서 보여주고있습니다.\n\n#### 이미지를 가져오는 순서\n\n갤러리 정보 요청 (이미지정보 포함) -\u003e 특수한 로직을 통해 이미지 링크 가져오기 -\u003e 이미지 링크에 referer, User-Agent 넣고 요청 -\u003e 200\n\n#### 리스트를 가져오는 순서\n\n.nozomi파일 요청 (번호 담겨있음) -\u003e 바이트로 응답온거 struct unpack으로 풀기 -\u003e 번호 정렬\n\n## 그래서 저걸 어떻게 알았나요?\n\nChrome에서 개발자도구로 js에서 요청하는 것들을 둘러보았고, 여러 사람들이 많은 도움을 주셨습니다.\n\n[이미지 처리 로직](https://ltn.hitomi.la/common.js)은 이곳에서 볼수 있었습니다.\n\n이외에는 충분히 여러분들이 노력만 하시면 어떻게 굴라가는지 보실수 있을겁니다.\n\n## 가져온 정보는 어떻게 저장하나요?\n\n먼저 **이미지는 저장하지 않습니다.** \n\n저장용량이 부족할뿐만 아니라, 여러 리스크가있기때문에 프록시로 받는 청크 그대로 넘겨주는것으로 결정했습니다.\n\n이외에 자세한 작품정보는 BeautifulSoup를 이용해 파싱후 mongodb에 저장하였고,\n\n이미지 정보와 같은것은 MariaDB와 Tortoise ORM을 이용해 저장했습니다.\n\n## 제목검색도 있던데 어떻게 하셨나요?\n\nMongodb cloud 에서 제공하는 Atlas Search를 이용했습니다.\n\n살짝 아쉬운점은 한국어가 아직 제대로 지원하지 않는다는 점입니다.\n\n## 배포는 어떻게 하셨나요?\n\nmaster 브랜치에 Push가 되면 Azure DevOps가 Docker를 빌드한후 깃허브에 이미지를 릴리즈합니다.\n\n배포서버에 ssh로 접속한후 그 이미지를 당겨온후 열어줍니다.\n\n그런 다음 Nginx로 리버스 프록시 작업을 해주었습니다.\n\n자동화 배포를 무중단배포와 함께 v5에서 기회가된다면 작업해보고싶네요.\n\n## 오류트래킹은 어떻게 하나요?\n\nsentry를 이용해 추적하고있습니다.\n\n***\n\n## 마지막으로 v4릴리즈를 앞두고..\n\n이글을 보고있으신다면 관심을 가져주시고 있다는거겠죠.\n\n먼저 봐주셔서 감사하다는 말씀을 드리고\n\n제가 열심히 유지보수한만큼 여러분들이 많이 써주시면 좋겠습니다.\n\nv4에 올라오면서 일부 엔드포인트를 제외하고 검증 절차를 삭제했기 때문에 요청하면 사용하실수 있습니다.\n\n다른 점이 궁금하신게있다면 디스코드로 질문해주셔도 됩니다.\n\n감사합니다!\n\n**[Saebasol Want you!](https://blog.doujinshiman.ga/post/saebasol-recruitment/)**\n\n**[공식 디스코드](https://discord.gg/PSshFYr)**\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"about-heliotrope"},"buildId":"UILk3oCLKYI5mfhHbLQ4H","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-c57da6e8818a9153d0ca.js"></script><script src="/_next/static/chunks/main-b78a0c769d36e7eef574.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.4012791932e9f5689531.js" async=""></script><script src="/_next/static/chunks/a0722373.a96f372fbac90ed0bc91.js" async=""></script><script src="/_next/static/chunks/7de4ed1085c5be3520cfe4b310dbaa2afeef88da.115d32a11aa091be966a.js" async=""></script><script src="/_next/static/chunks/14fd5275d4bbdbf606c5ae4a6109f5bb310e18a0.c03751eaa70038bfd13f.js" async=""></script><script src="/_next/static/chunks/94ac8896463642b673bdd9a437a96f00591a6ad8.8e125ec5b52d0fcc9a47.js" async=""></script><script src="/_next/static/chunks/be2f8df8c2c8cc83698c027fe529fd98ee6ea3ce.0746e855198c8743202a.js" async=""></script><script src="/_next/static/chunks/b44e4af87672e97627f752c1ce5896fd24a747b2.94c3935e876b0b466c33.js" async=""></script><script src="/_next/static/chunks/af34e2db61f97cedc6ebfbaa0d751a83f9f0d9f6.d30da2fa2fe476243b07.js" async=""></script><script src="/_next/static/chunks/pages/_app-7904a20271c4761d2a49.js" async=""></script><script src="/_next/static/chunks/e7a6caeb.ded972b50bbdd7ab7ea3.js" async=""></script><script src="/_next/static/chunks/686e6332.89681c4dcde130485dd7.js" async=""></script><script src="/_next/static/chunks/321dfbae.7b994ab64ce442378af9.js" async=""></script><script src="/_next/static/chunks/c82dffd34f5e63cb87dd90dca9c2897dd7794679.23e3fb14584ad9a717d3.js" async=""></script><script src="/_next/static/chunks/1173eff4538ab0eae4f3f506dea9a7965770ad37.4a63bcd2139829e6a011.js" async=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-5c632475bb0a040bf113.js" async=""></script><script src="/_next/static/UILk3oCLKYI5mfhHbLQ4H/_buildManifest.js" async=""></script><script src="/_next/static/UILk3oCLKYI5mfhHbLQ4H/_ssgManifest.js" async=""></script></body></html>